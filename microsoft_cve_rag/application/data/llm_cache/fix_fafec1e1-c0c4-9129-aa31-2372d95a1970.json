{
  "description": "**Fix Overview**:\n\nTo determine if the WinRE.wim file is patched, you should check the contents of the WinRE.wim directly, instead of relying on the DISM command. Specifically, for CVE-2024-20666, you need to inspect the winload.exe file as it addresses both CVE-2024-20666 and CVE-2022-4109 through a cumulative Safe OS update.\n\n1. Use the following generic PowerShell function to check the patched status of WinRE.wim:\n\n```powershell\n$null, $reloc = ( & (Get-Command \"$( $env:systemroot )\\system32\\reagentc.exe\" ) @('/info') | Where-Object { $_ -match 'Windows RE location:' } ) -split ':'\n$reloc = $reloc.Trim()\nGet-WinREPatchedFileVersion -ImagePath \"$( $reloc )\\WinRE.wim\" -Index 1\n```\n\n**Details**:\n- This function accepts the location of WinRE.wim as a parameter and retrieves the patched file version.\n- It is compatible with Windows 10 and Server 2022.\n- Ensure you have the necessary permissions to execute the PowerShell commands.\n\n**Preconditions**:\n- You may need administrative privileges to run the PowerShell function effectively.",
  "source_id": "fafec1e1-c0c4-9129-aa31-2372d95a1970",
  "source_type": "PatchManagementPost",
  "fix_label": "InspectWinREWimForPatchedStatus",
  "tags": [
    "PowerShell",
    "WinRE",
    "CumulativeUpdate",
    "Windows10"
  ],
  "node_id": "9d67f36a-5cc5-4c2d-8f44-dcd67aa3a1f2",
  "node_label": "Fix",
  "reliability": 0.9,
  "severity_type": "important",
  "entity_type": "Fix"
}
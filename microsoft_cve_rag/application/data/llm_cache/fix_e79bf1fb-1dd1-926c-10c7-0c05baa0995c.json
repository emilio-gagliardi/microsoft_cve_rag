{
  "description": "**Fix Overview**:\n\nTo update Server 2022 systems without resizing the recovery partition:\n\n1. Disable the recovery environment using the command:\n   ```powershell\n   reagentc /disable\n   ```\n2. Check if the WINRE file exists; if not, re-enable the recovery environment and exit:\n   ```powershell\n   $testpath = \"$env:windir\\system32\\recovery\\winre.wim\"\n   if (!(test-path $testpath)) {\n       Write-Output \"Recovery environment disabled but winre.wim not found at expected path $testpath. Something went wrong. Re-enabling recovery environment and quitting.\"\n       reagentc /enable\n       exit 1\n   }\n   ```\n3. Modify the recovery partition type as needed, without changing the actual object properties:\n   ```powershell\n   $rp = Get-Partition | ? { $_.Type -eq 'Recovery' }\n   if ($rp.GPTType -eq '{de94bba4-06d1-4d40-a16a-bfd50179d6ac}') {\n       $type = 'gpt';\n       $newtype = '{ebd0a0a2-b9e5-4433-87c0-68b6b72699c7}'\n   }\n   if ($rp.MBRType -eq '27') {\n       $type = 'mbr';\n       $newtype = '7'\n   }\n   Write-Output \"Found $type recovery partition at disk $($rp.DiskNumber) partition $($rp.PartitionNumber).\"\n   $rp | Set-Partition -GPTType $newtype\n   ```\n4. Re-enable the recovery environment:\n   ```powershell\n   reagentc /enable\n   ```\n5. After installation of both KB5034439 and KB5034441, restore the recovery environment to its original state:\n   ```powershell\n   reagentc /disable\n   ```\n   Restore the partition type:\n   ```powershell\n   if ($type -eq 'gpt') { $rp | Set-Partition -GPTType $($rp.GPTType); break }\n   if ($type -eq 'mbr') { $rp | Set-Partition -MBRType $($rp.MBRType); break }\n   ```\n\n**Details**:\nThis method allows updates to be re-applied while ensuring the recovery partition remains intact and correctly provisioned for future updates. It circumvents the need for resizing by managing the partition's state dynamically. (LLM Synthesized)",
  "source_id": "e79bf1fb-1dd1-926c-10c7-0c05baa0995c",
  "source_type": "PatchManagementPost",
  "fix_label": "update_server_2022_without_resizing_recovery_partition",
  "tags": [
    "KB5034441",
    "KB5034439",
    "Server2022",
    "PowerShell"
  ],
  "node_id": "9fd1feaf-44d0-4592-b1a5-85e9cee46c5d",
  "node_label": "Fix",
  "reliability": 0.8,
  "severity_type": "important",
  "entity_type": "Fix",
  "source_ids": [
    "e79bf1fb-1dd1-926c-10c7-0c05baa0995c"
  ],
  "verification_status": "unverified"
}
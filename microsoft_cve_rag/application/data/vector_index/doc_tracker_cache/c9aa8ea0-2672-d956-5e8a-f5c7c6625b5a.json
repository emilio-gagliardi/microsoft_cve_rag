{"node_id": "c9aa8ea0-2672-d956-5e8a-f5c7c6625b5a", "embedding": null, "excluded_embed_metadata_keys": ["id", "added_to_vector_store", "added_to_summary_index", "added_to_graph_store", "cve_fixes", "cve_mentions", "email_text_original", "unique_tokens", "tags"], "excluded_llm_metadata_keys": ["id", "added_to_vector_store", "added_to_summary_index", "added_to_graph_store", "cve_fixes", "cve_mentions", "email_text_original", "unique_tokens", "tags"], "text": "This little PS snippet may be useful for detecting if the recovery partition is\nproblematic. This is untested in the wild but it seems to be ok. \nI can\u2019t work out how to pull out the freespace. WMI returns an empty field for\nthe freespace on recovery partitions. Anyone know how to do this? \n$OutputLines = reagentc /info \n$Status = (($OutputLines[3] -split \":\")[1]) -replace '\\s','' \nif ($Status -ne 'Enabled') { \nwrite-host \"Recovery partition disabled\" \n} else { \n$PartitionPath = (($OutputLines[4] -split \":\")[1]) -Replace '\\s','' \n$PartitionPathElements = $PartitionPath -split \"\\\\\" \n$RecoveryPartitionNumber = [int]($PartitionPathElements[6] -replace\n'[a-z]','') + 1 \n$RecoveryPartition = Get-Partition -PartitionNumber\n$RecoveryPartitionNumber \n$RecoveryPartitionSize = $RecoveryPartition.size / 1Mb \n$RecoveryPartAccessPath = (get-partition -PartitionNumber\n$RecoveryPartitionNumber).AccessPaths[0] \n$RecoveryPartFreespace = (Get-WmiObject win32_volume | where {$_.DeviceId\n-eq $accesspath}).FreeSpace \n$BootDriveLetter = $Env:SystemDrive -replace ':','' \n$BootPartition = Get-Partition -DriveLetter $BootDriveLetter \n$BootPartitionNumber = [int]($BootPartition.PartitionNumeber) \nIf ($BootPartitionNumber -lt $RecoveryPartitionNumber ) { \nWrite-host \"OK: Recovery Partition After boot partition:\n$RecoveryPartitionNumber Size: $RecoveryPartitionSize Mb FreeSpace:\n$RecoveryPartFreespace\" \n} else { \nWrite-host \"Warning: Recovery Partition before boot partition:\n$RecoveryPartitionNumber Size: $RecoveryPartitionSize Mb FreeSpace:\n$RecoveryPartFreespace\" \n} \n} \nIan Murphy \n[cid:image002.png@01DA4A07.F4E38970] \n \n[cid:image003.png@01DA4A07.F4E38970] \n946 21 52 65 [tel:946%2021%2052%2065] \n[cid:image004.png@01DA4A07.F4E38970] \n617 79 26 44 [tel:617%2079%2026%2044] \n[cid:image005.png@01DA4A07.F4E38970] \nwww.integra-xp.com\n \n[cid:image006.png@01DA4A07.F4E38970] \nSasikoa, 26 \u2011 2\u00ba CD \n48200 \n\u00b7 \nDurango \n\u00b7 \nBizkaia \nEn cumplimiento de la normativa relativa a la Protecci\u00f3n de Datos de Car\u00e1cter\nPersonal, se le informa que los datos personales facilitados son tratados por\nIntegra Experience S.L., CIF B95233854 y domicilio en la calle Sasikoa, 26 2\u00ba\nCD, 48200 Durango (Bizkaia). La finalidad del tratamiento es la poder gestionar\nla relaci\u00f3n comercial que nos une y mantenerle informado de nuestros productos y\nservicios tanto durante su relaci\u00f3n actual con Integra Experience S.L., como a\nfuturo, siempre que no nos haya comunicado la revocaci\u00f3n de su consentimiento.\nSus datos no son cedidos a terceros ajenos a Integra Experience S.L. En todo\ncaso, le recordamos que podr\u00e1 ejercitar sus derechos de protecci\u00f3n de datos\nestablecidos en el Reglamento en la direcci\u00f3n anteriormente indicada, o enviando\nun email a , as\u00ed como el derecho a presentar una reclamaci\u00f3n\nante la Agencia Espa\u00f1ola de Protecci\u00f3n de Datos. \nEl contenido de este correo electr\u00f3nico y de sus anexos es estrictamente\nconfidencial. En el supuesto de que Vd. no sea el destinatario y haya recibido\neste mensaje por error, le agradeceremos que lo comunique al remitente, sin\ndifundir, almacenar o copiar su contenido.\n%40GV2PR03MB9355.eurprd03.prod.outlook.com", "metadata": {"id": "c9aa8ea0-2672-d956-5e8a-f5c7c6625b5a", "receivedDateTime": "2024-01-18T13:01:20+00:00", "topic": "Feedback to Microsoft", "subject": "RE: [patchmanagement] Feedback to Microsoft", "published": "2024-01-18T00:00:00", "collection": "patch_management", "cve_fixes": "", "cve_mentions": null, "tags": "", "conversation_link": "//groups.google.com/d/msgid/patchmanagement/GV2PR03MB9355638C7ABDD9D66BE21E8B94712%40GV2PR03MB9355.eurprd03.prod.outlook.com", "email_text_original": "No suele recibir correos electr\u00f3nicos de ian@integra-xp.com. Por qu\u00e9 esto es\nimportante [https://aka.ms/LearnAboutSenderIdentification] \nThis little PS snippet may be useful for detecting if the recovery partition is\nproblematic. This is untested in the wild but it seems to be ok. \nI can\u2019t work out how to pull out the freespace. WMI returns an empty field for\nthe freespace on recovery partitions. Anyone know how to do this? \n$OutputLines = reagentc /info \n$Status = (($OutputLines[3] -split \":\")[1]) -replace '\\s','' \nif ($Status -ne 'Enabled') { \nwrite-host \"Recovery partition disabled\" \n} else { \n$PartitionPath = (($OutputLines[4] -split \":\")[1]) -Replace '\\s','' \n$PartitionPathElements = $PartitionPath -split \"\\\\\" \n$RecoveryPartitionNumber = [int]($PartitionPathElements[6] -replace\n'[a-z]','') + 1 \n$RecoveryPartition = Get-Partition -PartitionNumber\n$RecoveryPartitionNumber \n$RecoveryPartitionSize = $RecoveryPartition.size / 1Mb \n$RecoveryPartAccessPath = (get-partition -PartitionNumber\n$RecoveryPartitionNumber).AccessPaths[0] \n$RecoveryPartFreespace = (Get-WmiObject win32_volume | where\u00a0 {$_.DeviceId\n-eq $accesspath}).FreeSpace \n$BootDriveLetter = $Env:SystemDrive -replace ':','' \n$BootPartition = Get-Partition -DriveLetter $BootDriveLetter \n$BootPartitionNumber = [int]($BootPartition.PartitionNumeber) \nIf ($BootPartitionNumber -lt $RecoveryPartitionNumber ) { \nWrite-host \"OK: Recovery Partition After boot partition:\n$RecoveryPartitionNumber Size: $RecoveryPartitionSize Mb FreeSpace:\n$RecoveryPartFreespace\" \n} else { \nWrite-host \"Warning: Recovery Partition before boot partition:\n$RecoveryPartitionNumber Size: $RecoveryPartitionSize Mb FreeSpace:\n$RecoveryPartFreespace\" \n} \n} \nIan\u00a0Murphy \n[cid:image002.png@01DA4A07.F4E38970] \nian@integra-xp.com \n[cid:image003.png@01DA4A07.F4E38970] \n946\u00a021\u00a052\u00a065 [tel:946%2021%2052%2065] \n[cid:image004.png@01DA4A07.F4E38970] \n617\u00a079\u00a026\u00a044 [tel:617%2079%2026%2044] \n[cid:image005.png@01DA4A07.F4E38970] \nwww.integra-xp.com\n[https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.integra-xp.com%2F&data=05%7C02%7Cemail_ingestion%40bighatgroup.com%7C0f41f9680e9243fe805608dc18258be2%7C5a01497e1bcb4711b6e6d24f4ab00393%7C0%7C0%7C638411796798295137%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=PudpucrhXkGtm5y2mfOudb1uWTB2o1rH6yC8%2B41PKts%3D&reserved=0] \n[cid:image006.png@01DA4A07.F4E38970] \nSasikoa,\u00a026\u00a0\u2011\u00a02\u00ba\u00a0CD \n48200 \n\u00b7 \nDurango \n\u00b7 \nBizkaia \nEn cumplimiento de la normativa relativa a la Protecci\u00f3n de Datos de Car\u00e1cter\nPersonal, se le informa que los datos personales facilitados son tratados por\nIntegra Experience S.L., CIF B95233854 y domicilio en la calle Sasikoa, 26\u00a0 2\u00ba\nCD, 48200 Durango (Bizkaia). La finalidad del tratamiento es la poder gestionar\nla relaci\u00f3n comercial que nos une y mantenerle informado de nuestros productos y\nservicios tanto durante su relaci\u00f3n actual con Integra Experience S.L., como a\nfuturo, siempre que no nos haya comunicado la revocaci\u00f3n de su consentimiento.\nSus datos no son cedidos a terceros ajenos a Integra Experience S.L. En todo\ncaso, le recordamos que podr\u00e1 ejercitar sus derechos de protecci\u00f3n de datos\nestablecidos en el Reglamento en la direcci\u00f3n anteriormente indicada, o enviando\nun email a gprd@integra-xp.com, as\u00ed como el derecho a presentar una reclamaci\u00f3n\nante la Agencia Espa\u00f1ola de Protecci\u00f3n de Datos. \nEl contenido de este correo electr\u00f3nico y de sus anexos es estrictamente\nconfidencial. En el supuesto de que Vd. no sea el destinatario y haya recibido\neste mensaje por error, le agradeceremos que lo comunique al remitente, sin\ndifundir, almacenar o copiar su contenido.\nLink: https://groups.google.com/d/msgid/patchmanagement/GV2PR03MB9355638C7ABDD9D66BE21E8B94712%40GV2PR03MB9355.eurprd03.prod.outlook.com \n", "evaluated_keywords": "['recovery partition disabled', 'little ps snippet may', 'wmiobject win32_volume', 'wmi return']", "evaluated_noun_chunks": "[\"This little PS snippet\", \"the recovery partition\", \"the freespace\", \"recovery partitions\"]", "post_type": "Problem statement", "unique_tokens": 230, "product_build_ids": [], "cve_ids": null, "etl_processing_status": {"document_processed": true, "entities_extracted": true, "graph_prepared": true, "vector_prepared": true, "last_processed_at": "2025-01-03T16:42:10.913083", "processing_version": "1.0"}, "is_processed": true, "next_id": "d884843d-c34c-5947-806a-93d2f5001fac", "previous_id": "ef3a5f1b-c88d-758c-318e-cff0728b5eae", "product_mentions": [], "thread_id": "feedback_microsoft", "build_numbers": [], "kb_ids": [], "noun_chunks": "[\"This little PS snippet\", \"the recovery partition\", \"the freespace\", \"recovery partitions\"]", "keywords": "['recovery partition disabled', 'little ps snippet may', 'wmiobject win32_volume', 'wmi return']", "node_label": "PatchManagementPost"}, "added_at": "2025-01-03T16:36:06.349443", "last_updated": "2025-01-04T21:08:04.061012"}
{"node_id": "5a5a7b98-1e32-c6bc-0cbc-e2a6fb11f994", "kb_id": "KB-5040442", "title": "July 9, 2024\u2014KB5040442 (OS Builds 22621.3880 and 22631.3880) - Microsoft Support", "text": " \nJuly 9, 2024\u2014KB5040442 (OS Builds 22621.3880 and 22631.3880) \nWindows 11 version 22H2, all editions \nWindows 11 version 23H2, all editions \nMore... \nLess \nYou\u2019re invited to try Microsoft 365 for free \nUnlock now \nRelease Date: \n7/9/2024 \nVersion: \nOS Builds 22621.3880 and 22631.3880 \nNEW \n 07/09/24--- \nEND OF SERVICE NOTICE \n--- \nIMPORTANT  \nHome and Pro editions of Windows 11, version 22H2 will reach end of service on October 8, 2024. Until then, these editions will only receive security updates. They will not receive non-security, preview updates. To continue receiving security and non-security updates after October 8, 2024, we recommend that you update to the latest version of Windows. \nNote  \nWe will continue to support Enterprise and Education editions after October 8, 2024. \nFor\u00a0information about Windows update terminology, see the article\u00a0about the\u00a0 \ntypes of Windows updates \n\u00a0and the\u00a0 \nmonthly quality update types \n. For an overview of Windows 11, version 23H2, see its  \nupdate history page \n. \nNote\u00a0 \nFollow\u00a0 \n@WindowsUpdate \n\u00a0to find out when new content is published to the Windows release health dashboard. \nHighlights \nBelow is a summary of the key issues that this update addresses when you install this KB. If there are new features, it lists them as well. \nTaskbar (known issue) \n You might not be able to view or interact with the taskbar after you install KB5039302. This issue occurs on devices that run the Windows N edition. This edition is like other editions but lacks most media-related tools. The issue also occurs if you turn off \u201cMedia Features\u201d from the Control Panel. \nImprovements \nNote:\u00a0 \nTo view the list of addressed issues, click or tap the OS name to expand the collapsible section. \nWindows 11, version 23H2 \nImportant:\u00a0 \nUse EKB\u00a0 \nKB5027397 \n\u00a0to update to Windows 11, version 23H2. \nThis security update includes quality improvements. Key changes include: \nThis build includes all the improvements in\u00a0Windows 11, version 22H2. \nNo additional issues are documented for this release. \nWindows 11, version 22H2 \nThis security update includes improvements that were a part of update  \nKB5039302\u00a0 \n(released June 25, 2024).\u00a0Below is a summary of the key issues that this update addresses when you install this KB. If there are new features, it lists them as well. \nWindows Installer \n. When it repairs an application, the User Account Control (UAC) does not prompt for your credentials. After you install this update, the UAC will prompt for them. Because of this, you might have to update your automation scripts. Do this by adding the Shield icon. It indicates that the process requires full administrator access. To turn off the UAC prompt, set the  \nHKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\DisableLUAInRepair \n registry value to  \n1 \n. For more information, see: \nApplication Resiliency: Unlock the Hidden Features of Windows Installer \nMachine Policies - Win32 apps \nRemote Desktop MultiPoint Server \n. A race condition causes the service to stop responding. \nRemote Authentication Dial-In User Service (RADIUS) protocol \n. This issue is related to MD5 collisions. For more information, see  \nKB5040268 \n. \nIf you installed earlier updates, only the new updates contained in this package will be downloaded and installed on your device. \nFor more information about security vulnerabilities, please refer to the  \nSecurity Update Guide \n website and the  \nJuly 2024 Security Updates \n. \nWindows 11\u00a0servicing stack update (KB5039338) - 22621.3801 and 22631.3801 \nThis update makes quality improvements to the servicing stack, which is the component that installs Windows updates. Servicing stack updates (SSU) ensure that you have a robust and reliable servicing stack so that your devices can receive and install Microsoft updates. \nKnown issues in this update \nApplies to \nSymptom \nWorkaround \nEnterprise users \nAfter installing this update or later updates, you might face issues while upgrading from Windows Pro to a valid Windows Enterprise subscription. \nResulting from this operation, you might observe the following symptoms: - OS upgrade operations may fail, and this might be shown in the LicenseAcquisition scheduled task in Task Scheduler -> Task Scheduler Library -> Microsoft -> Windows -> Subscription as \u2018Access denied error (error code 0x80070005)\u2019 under \u2018Last Run Result\u2019. \nWe are working on a resolution that will be released on a Windows update in the coming weeks. \nHow to get this update \nBefore you install this update \nMicrosoft combines the latest servicing stack update (SSU) for your operating system with the latest cumulative update (LCU).\u00a0For general information about SSUs,\u00a0see  \nServicing stack updates \n\u00a0and\u00a0 \nServicing Stack Updates (SSU): Frequently Asked Questions \n. \nInstall this update \nTo install this update, use one of the following Windows and Microsoft release channels. \nWindows Update \nBusiness \nCatalog \nServer Update Services \nAvailable \nNext Step \nYes \nNone. This update will be downloaded and installed automatically from Windows Update and Microsoft Update. \nAvailable \nNext Step \nYes \nNone. This update will be downloaded and installed automatically from Windows Update for Business in accordance with configured policies. \nAvailable \nNext Step \nYes \nTo get the standalone package for this update, go to the\u00a0 \nMicrosoft Update Catalog \n\u00a0website. \nAvailable \nNext Step \nYes \nThis update will automatically sync\u00a0with Windows Server Update Services (WSUS) if you configure  \nProducts and Classifications \n as follows: \nProduct \n: Windows 11 \nClassification \n: Security Updates \nIf you want to remove the LCU \nTo remove the LCU after installing the combined SSU and LCU package, use the  \nDISM/Remove-Package \n command line option with the LCU package name as the argument. You can find the package name\u00a0by using this command:  \nDISM /online /get-packages \n. \nRunning  \nWindows Update Standalone Installer \n ( \nwusa.exe \n) with the  \n/uninstall  \nswitch on the combined package will not work because the combined package contains the SSU. You cannot remove the SSU from the system after installation. \nFile information \nFor a list of the files that are provided in this update, download the\u00a0 \nfile information for cumulative update 5040442 \n. \nFor a list of the files that are provided in the servicing stack update, download the\u00a0 \nfile information for the SSU (KB5039338) - versions 22621.3801 and 22631.3801 \n. \nSUBSCRIBE RSS FEEDS \nNeed more help? \nWant more options? \nDiscover \nCommunity \nExplore subscription benefits, browse training courses, learn how to secure your device, and more. \nMicrosoft 365 subscription benefits \nMicrosoft 365 training \nMicrosoft security \nAccessibility center \nCommunities help you ask and answer questions, give feedback, and hear from experts with rich knowledge. \nAsk the Microsoft Community \nMicrosoft Tech Community \nWindows Insiders \nMicrosoft 365 Insiders \n", "published": "2024-07-09T00:00:00", "product_build_id": "70eda68d-f686-8389-3f06-79342faf6bea", "build_number": [10, 0, 22631, 3880], "excluded_embed_metadata_keys": ["node_label", "build_number", "node_id", "product_build_id", "product_build_ids", "cve_ids"], "article_url": "https://support.microsoft.com/help/5040442", "summary": "KB5040442 is a cumulative security update released on July 9, 2024, for Windows 11 version 22H2 and version 23H2 (OS Builds 22621.3880 and 22631.3880). It addresses several critical vulnerabilities including UAC credential prompts during Windows Installer repairs and RADIUS protocol issues related to MD5 collisions. Administrators must ensure that the latest servicing stack update (KB5039338) is applied, as the cumulative update package includes this SSU and cannot be uninstalled independently. Notably, the Home and Pro editions of Windows 11 version 22H2 will reach end-of-service status on October 8, 2024, necessitating upgrades for continued support.\n\n**Technical Breakdown**\n\n**Vulnerabilities and Exploits**:\n- This update addresses high-impact vulnerabilities including:\n  - User Account Control (UAC) not prompting for credentials during Windows Installer repairs.\n  - Remote Authentication Dial-In User Service (RADIUS) protocol issues related to MD5 collisions. Full details are available in the July 2024 Security Updates.\n\n**Known Issues**:\n- **Taskbar Visibility Problem**\n  - Impact: Windows N edition users may lose taskbar functionality after installing KB5039302.\n  - Resolution: Ensure \"Media Features\" is enabled in Control Panel.\n  \n- **Enterprise Upgrade Failure**\n  - Symptom: OS upgrade operations may fail, returning an access denied error (error code 0x80070005).\n  - Status: A resolution will be addressed in an upcoming update.\n\n**Commands and Registry Keys**:\n- To disable the UAC prompt during Windows Installer repairs, modify the registry:\n  ```\n  [Registry Key]\n  `HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\DisableLUAInRepair` = `1`\n  ```\n  \n- To remove the installed LCU if necessary, use the following command after determining the package name:\n  ```\n  [Powershell]\n  ```powershell\n  DISM /online /remove-package /packagename:<Package Name>\n  ```\n\n**Installation Process and Prerequisites**:\n1. Ensure that the latest SSU (KB5039338) is installed before applying this update.\n2. Use the following channels for update installation:\n   - **Windows Update**: Automatically installed.\n   - **Windows Update for Business**: Automatically installed based on configured policies.\n   - **Standalone Package**: Available through the Microsoft Update Catalog.\n   - **WSUS**: Syncs automatically if configured correctly with appropriate product and classification settings.\n\n3. For uninstallation:\n   ```\n   [Powershell]\n   ```powershell\n   DISM /online /get-packages\n   ``` \n   Identify the package name from the output and use it in the remove command as specified above.", "metadata": {"product_build_ids": ["fdbb56d3-d1aa-6819-59bd-dc326d0b64c0", "70eda68d-f686-8389-3f06-79342faf6bea"], "cve_ids": ["CVE-2024-21417", "CVE-2024-26184", "CVE-2024-28899", "CVE-2024-30013", "CVE-2024-30071", "CVE-2024-30079", "CVE-2024-30081", "CVE-2024-30098", "CVE-2024-35270", "CVE-2024-3596", "CVE-2024-37969", "CVE-2024-37970", "CVE-2024-37971", "CVE-2024-37972", "CVE-2024-37973", "CVE-2024-37974", "CVE-2024-37975", "CVE-2024-37977", "CVE-2024-37978", "CVE-2024-37981", "CVE-2024-37984", "CVE-2024-37986", "CVE-2024-37987", "CVE-2024-37988", "CVE-2024-37989", "CVE-2024-38010", "CVE-2024-38011", "CVE-2024-38013", "CVE-2024-38017", "CVE-2024-38019", "CVE-2024-38022", "CVE-2024-38025", "CVE-2024-38027", "CVE-2024-38028", "CVE-2024-38030", "CVE-2024-38032", "CVE-2024-38033", "CVE-2024-38034", "CVE-2024-38041", "CVE-2024-38043", "CVE-2024-38047", "CVE-2024-38048", "CVE-2024-38049", "CVE-2024-38050", "CVE-2024-38051", "CVE-2024-38052", "CVE-2024-38053", "CVE-2024-38054", "CVE-2024-38055", "CVE-2024-38056", "CVE-2024-38057", "CVE-2024-38058", "CVE-2024-38059", "CVE-2024-38060", "CVE-2024-38061", "CVE-2024-38062", "CVE-2024-38064", "CVE-2024-38065", "CVE-2024-38068", "CVE-2024-38069", "CVE-2024-38070", "CVE-2024-38078", "CVE-2024-38079", "CVE-2024-38080", "CVE-2024-38085", "CVE-2024-38091", "CVE-2024-38101", "CVE-2024-38102", "CVE-2024-38104", "CVE-2024-38105", "CVE-2024-38112", "CVE-2024-38517", "CVE-2024-39684"], "excluded_llm_metadata_keys": null, "node_label": "KBArticle", "update_package_url": "https://catalog.update.microsoft.com/Search.aspx?q=KB5040442", "etl_processing_status": {"document_processed": true, "entities_extracted": false, "graph_prepared": false, "vector_prepared": false, "last_processed_at": null, "processing_version": "1.0"}}, "added_at": "2025-01-21T17:57:25.063193", "last_updated": "2025-01-29T12:29:31.617480"}
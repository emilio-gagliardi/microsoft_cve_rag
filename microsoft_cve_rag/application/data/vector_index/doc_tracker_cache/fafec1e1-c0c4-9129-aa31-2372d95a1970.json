{"node_id": "fafec1e1-c0c4-9129-aa31-2372d95a1970", "text": "Hi,\nTo find out if WinRE.wim is patched, I'd not use the dism.exe /get-wiminfo \nIt would be better to inspect the content of WinRE.wim. \nFor the previous cve-2022-4109, you needed to check the BootMenuUX.dll. I've\nblogged about it (see\nhttps://p0w3rsh3ll.wordpress.com/2023/04/06/patching-cve-2022-41099/\n) \nFor the current cve-2024-20666, you need to check winload.exe\nIt also patches the cve-2022-4109 because it's a cumulative Safe OS update :) \nHere's a generic Powershell function to do that\nhttps://gist.github.com/p0w3rsh3ll/27cf8f9bd95c9c7ea6271e5d349f3b72\n \nIt works on Windows 10 et Server 2022.\nIt accepts the WinRE.wim location as a parameter. The value you get from\nreagentc.exe /info \n$null,$RELoc = ((& (Get-Command \"$($env:systemroot)\\system32\\ReAgentC.exe\")\n@('/info')) | Where-Object { $_ -match 'Windows\\sRE\\slocation:' } ) -split ':'\n$RELoc = $RELoc.Trim()\nGet-WinREPatchedFileVersion -ImagePath \"$($RELoc)\\winre.wim\" -Index 1", "embedding": null, "excluded_embed_metadata_keys": ["id", "added_to_vector_store", "added_to_summary_index", "added_to_graph_store", "cve_fixes", "cve_mentions", "email_text_original", "unique_tokens", "tags"], "excluded_llm_metadata_keys": ["id", "added_to_vector_store", "added_to_summary_index", "added_to_graph_store", "cve_fixes", "cve_mentions", "email_text_original", "unique_tokens", "tags"], "metadata": {"id": "fafec1e1-c0c4-9129-aa31-2372d95a1970", "receivedDateTime": "2024-01-24T09:12:36+00:00", "topic": "Win11 22h2 and later - they don't need 250 free? Yes? No? and what about checking if you are patched? (aka I'm confused)", "subject": "Re: [patchmanagement] Win11 22h2 and later - they don't need 250 free? Yes? No? and what about checking if you are patched? (aka I'm confused)", "published": "2024-01-24T00:00:00", "collection": "patch_management", "cve_fixes": "", "cve_mentions": null, "tags": "", "conversation_link": "//groups.google.com/d/msgid/patchmanagement/CAGN5iagT1NBWKq4bPpDT8fsGHUUz%2B%2BhnSaTggc8%3Dzh_02w%3DwWw%40mail.gmail.com", "email_text_original": "Hi,\nTo find out if WinRE.wim is patched, I'd not use the dism.exe /get-wiminfo \nIt would be better to inspect the content of WinRE.wim. \nFor the previous cve-2022-4109, you needed to check the\u00a0BootMenuUX.dll. I've\nblogged about it (see\nhttps://p0w3rsh3ll.wordpress.com/2023/04/06/patching-cve-2022-41099/\n[https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fp0w3rsh3ll.wordpress.com%2F2023%2F04%2F06%2Fpatching-cve-2022-41099%2F&data=05%7C02%7Cemail_ingestion%40bighatgroup.com%7C935a8bb4b5454b79d34108dc1cbc9984%7C5a01497e1bcb4711b6e6d24f4ab00393%7C0%7C0%7C638416843558501499%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=3dLHIbuQ5RjfPdChNOEabCPmu3v6oYKJoAQsoi72RUA%3D&reserved=0]) \nFor the current cve-2024-20666, you need to check winload.exe\nIt also patches the cve-2022-4109 because it's a cumulative Safe OS update :) \nHere's a generic Powershell function to do that\nhttps://gist.github.com/p0w3rsh3ll/27cf8f9bd95c9c7ea6271e5d349f3b72\n[https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgist.github.com%2Fp0w3rsh3ll%2F27cf8f9bd95c9c7ea6271e5d349f3b72&data=05%7C02%7Cemail_ingestion%40bighatgroup.com%7C935a8bb4b5454b79d34108dc1cbc9984%7C5a01497e1bcb4711b6e6d24f4ab00393%7C0%7C0%7C638416843558510180%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=%2BeDmRobli0kERTNjPtCR1z2bEseCycUt7Jr1JcT9Gq8%3D&reserved=0] \nIt works on Windows 10 et Server 2022.\nIt accepts the WinRE.wim location as a parameter. The value you get from\nreagentc.exe /info \n$null,$RELoc = ((& (Get-Command \"$($env:systemroot)\\system32\\ReAgentC.exe\")\n@('/info')) | Where-Object { $_ -match 'Windows\\sRE\\slocation:' } ) -split ':'\n$RELoc = $RELoc.Trim()\nGet-WinREPatchedFileVersion -ImagePath \"$($RELoc)\\winre.wim\" -Index 1 \nOn Wed, Jan 24, 2024 at 2:01\u202fAM 'Susan Bradley' via PatchManagement\n<patchmanagement@googlegroups.com\nLink: https://groups.google.com/d/msgid/patchmanagement/CAGN5iagT1NBWKq4bPpDT8fsGHUUz%2B%2BhnSaTggc8%3Dzh_02w%3DwWw%40mail.gmail.com \n", "evaluated_keywords": "['cumulative safe os update :)', 'windows 10 et server 2022', 'generic powershell function', 'previous cve']", "evaluated_noun_chunks": "[\"the dism.exe /get-wiminfo\", \"the BootMenuUX.dll\", \"a cumulative Safe OS\", \"a generic Powershell function\"]", "post_type": "Solution provided", "unique_tokens": 93, "product_build_ids": [], "cve_ids": null, "etl_processing_status": {"document_processed": true, "entities_extracted": true, "graph_prepared": true, "vector_prepared": true, "last_processed_at": "2025-01-03T17:19:07.365045", "processing_version": "1.0"}, "is_processed": true, "next_id": "efa711f7-48c6-9839-2cec-066e45327f4b", "previous_id": "0f5c6375-2c1f-5d1e-7fef-f5e3c5c8de00", "product_mentions": [], "thread_id": "win11_22h2_later_dont_need_250_free_yes_checking_patched_aka_im_confused", "noun_chunks": "[\"the dism.exe /get-wiminfo\", \"the BootMenuUX.dll\", \"a cumulative Safe OS\", \"a generic Powershell function\"]", "keywords": "['cumulative safe os update :)', 'windows 10 et server 2022', 'generic powershell function', 'previous cve']", "node_label": "PatchManagementPost", "kb_ids": [], "build_numbers": []}, "added_at": "2025-01-03T17:16:38.009104", "last_updated": "2025-01-05T08:40:33.446273"}
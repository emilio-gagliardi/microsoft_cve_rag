{"node_id": "fa14f87b-11c5-fb5a-c803-3693034bc192", "embedding": null, "excluded_embed_metadata_keys": ["id", "added_to_vector_store", "added_to_summary_index", "added_to_graph_store", "cve_fixes", "cve_mentions", "email_text_original", "unique_tokens", "tags"], "excluded_llm_metadata_keys": ["id", "added_to_vector_store", "added_to_summary_index", "added_to_graph_store", "cve_fixes", "cve_mentions", "email_text_original", "unique_tokens", "tags"], "text": "I think that there's a major issue with this script:\nhttps://support.microsoft.com/en-us/topic/kb5034957-updating-the-winre-partition-on-deployed-devices-to-address-security-vulnerabilities-in-cve-2024-20666-0190331b-1ca3-42d8-8a55-7fc406910c10\n \nIt's the exact same script for the previous vulnerability CVE-2022-41099\nhttps://support.microsoft.com/en-us/topic/kb5025175-updating-the-winre-partition-on-deployed-devices-to-address-security-vulnerabilities-in-cve-2022-41099-ba6621fa-5a9f-48f1-9ca3-e13eb56fb589\n\nThe script checks if WinRE needs patching by checking the file version of\nbootmenuux.dll.\nIf it's equal or greater than some hardcoded versions (depending on the OS\nversion being patched), then it says the patch is already installed.\nIt doesn't add the patch with dism.exe /addpackage...\nWe can actually see it in action in the screenshot on this page:\nhttps://www.bleepingcomputer.com/news/microsoft/microsoft-shares-script-to-update-windows-10-winre-with-bitlocker-fixes/\n\nIt starts by examining bootmenuux.dll inside WinRE.wim and because it already\nhas the expected, it does almost nothing. \nimage.png [cid:ii_lrgad7wv0] \nThis script for CVE-2024-20666 would have required some editing by Microsoft. \nIt requires to update how it finds out if the new SafOS package that fixes\nCVE-2024-20666 has been applied.\nThe script should actually check for files documented on this page:\nhttps://support.microsoft.com/en-us/topic/kb5034232-compatibility-update-for-installing-and-recovering-windows-10-version-21h2-and-22h2-january-9-2024-93af23bb-0d5f-4f19-8a36-401443b53ad9\n\nFor example, it should check these files (the most recent files with the highest\nfile version) \nimage.png [cid:ii_lrgap8dr1] \nBecause, KB5034232 is a cumulative update, it fixes both CVE-2024-20666 and the\nprevious vulnerability ( CVE-2022-41099 ) by patching \nimage.png [cid:ii_lrgarc1a2] \nIf you used this script, you'd think that WinRE.wim is patched but it's not.", "metadata": {"id": "fa14f87b-11c5-fb5a-c803-3693034bc192", "receivedDateTime": "2024-01-16T12:03:46+00:00", "topic": "Re: KB5034957: Updating the WinRE partition on deployed devices to address security vulnerabilities in CVE-2024-20666", "subject": "[patchmanagement] Re: KB5034957: Updating the WinRE partition on deployed devices to address security vulnerabilities in CVE-2024-20666", "published": "2024-01-16T00:00:00", "collection": "patch_management", "cve_fixes": "", "cve_mentions": null, "tags": "", "conversation_link": "//groups.google.com/d/msgid/patchmanagement/CAGN5iag5fSW%3DXB_a%2BZD4s3zpddv3sQLNLb3hH4Hedzq6AFbQtg%40mail.gmail.com", "email_text_original": "I think that there's a major issue with this script:\nhttps://support.microsoft.com/en-us/topic/kb5034957-updating-the-winre-partition-on-deployed-devices-to-address-security-vulnerabilities-in-cve-2024-20666-0190331b-1ca3-42d8-8a55-7fc406910c10\n[https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fsupport.microsoft.com%2Fen-us%2Ftopic%2Fkb5034957-updating-the-winre-partition-on-deployed-devices-to-address-security-vulnerabilities-in-cve-2024-20666-0190331b-1ca3-42d8-8a55-7fc406910c10&data=05%7C02%7Cemail_ingestion%40bighatgroup.com%7C55b820fe89894fb61ef708dc168b2f34%7C5a01497e1bcb4711b6e6d24f4ab00393%7C0%7C0%7C638410034260420112%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=fdrn9Z5oB2wpZkWx6Ih%2FRWnd%2BF1UJgf24v4E1w5Nzdg%3D&reserved=0] \nIt's the exact same script for the previous vulnerability CVE-2022-41099\nhttps://support.microsoft.com/en-us/topic/kb5025175-updating-the-winre-partition-on-deployed-devices-to-address-security-vulnerabilities-in-cve-2022-41099-ba6621fa-5a9f-48f1-9ca3-e13eb56fb589\n[https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fsupport.microsoft.com%2Fen-us%2Ftopic%2Fkb5025175-updating-the-winre-partition-on-deployed-devices-to-address-security-vulnerabilities-in-cve-2022-41099-ba6621fa-5a9f-48f1-9ca3-e13eb56fb589&data=05%7C02%7Cemail_ingestion%40bighatgroup.com%7C55b820fe89894fb61ef708dc168b2f34%7C5a01497e1bcb4711b6e6d24f4ab00393%7C0%7C0%7C638410034260420112%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=D8t08hkUuoeRzFJg%2FplA1aXrn%2FWfopJ7V8nvgw5Japc%3D&reserved=0]\nThe script checks if WinRE needs patching by checking the file version of\nbootmenuux.dll.\nIf it's equal or greater than some hardcoded versions (depending on the OS\nversion being patched), then it says the patch is already installed.\nIt doesn't add the patch with dism.exe /addpackage...\nWe can actually see it in action in the screenshot on this page:\nhttps://www.bleepingcomputer.com/news/microsoft/microsoft-shares-script-to-update-windows-10-winre-with-bitlocker-fixes/\n[https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.bleepingcomputer.com%2Fnews%2Fmicrosoft%2Fmicrosoft-shares-script-to-update-windows-10-winre-with-bitlocker-fixes%2F&data=05%7C02%7Cemail_ingestion%40bighatgroup.com%7C55b820fe89894fb61ef708dc168b2f34%7C5a01497e1bcb4711b6e6d24f4ab00393%7C0%7C0%7C638410034260420112%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=2gpjxFVPVFW0tbc2deFQFxudr85Gsh%2FTbyAwU%2BB1DVM%3D&reserved=0]\nIt starts by examining bootmenuux.dll inside WinRE.wim and because it already\nhas the expected, it does almost nothing. \nimage.png [cid:ii_lrgad7wv0] \nThis script for CVE-2024-20666 would have required some editing by Microsoft.\u00a0\nIt requires to update how it finds out if the new SafOS package that fixes\nCVE-2024-20666 has been applied.\nThe script should actually check for files documented on this page:\nhttps://support.microsoft.com/en-us/topic/kb5034232-compatibility-update-for-installing-and-recovering-windows-10-version-21h2-and-22h2-january-9-2024-93af23bb-0d5f-4f19-8a36-401443b53ad9\n[https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fsupport.microsoft.com%2Fen-us%2Ftopic%2Fkb5034232-compatibility-update-for-installing-and-recovering-windows-10-version-21h2-and-22h2-january-9-2024-93af23bb-0d5f-4f19-8a36-401443b53ad9&data=05%7C02%7Cemail_ingestion%40bighatgroup.com%7C55b820fe89894fb61ef708dc168b2f34%7C5a01497e1bcb4711b6e6d24f4ab00393%7C0%7C0%7C638410034260576365%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=mtp4h2UVdJoffdsPRUsHki1lnSzZUYURErqIrXA8Fiw%3D&reserved=0]\nFor example, it should check these files (the most recent files with the highest\nfile version) \nimage.png [cid:ii_lrgap8dr1] \nBecause, KB5034232 is a cumulative update, it fixes both CVE-2024-20666 and the\nprevious vulnerability ( CVE-2022-41099 ) by patching \nimage.png [cid:ii_lrgarc1a2] \nIf you used this script, you'd think that WinRE.wim is patched but it's not. \nOn Tue, Jan 9, 2024 at 7:25\u202fPM Emin <emin.atac@gmail.com\nLink: https://groups.google.com/d/msgid/patchmanagement/CAGN5iag5fSW%3DXB_a%2BZD4s3zpddv3sQLNLb3hH4Hedzq6AFbQtg%40mail.gmail.com \n", "evaluated_keywords": "['major issue', 'previous vulnerability cve', 'winre need patch', 'new safos package']", "evaluated_noun_chunks": "[\"a major issue\", \"this script\", \"the previous vulnerability\", \"the new SafOS package\"]", "post_type": "Problem statement", "unique_tokens": 117, "product_build_ids": [], "thread_id": "kb5034957_updating_winre_partition_deployed_devices_address_security_vulnerabilities_cve202420666", "previous_id": "9e03dddb-5560-5db1-b679-8640642a37d3", "next_id": "41781d13-e3e3-e17d-7ef4-43eb5f65634a", "etl_processing_status": {"document_processed": true, "entities_extracted": false, "graph_prepared": false, "vector_prepared": false, "last_processed_at": "2025-01-03T23:16:27.668074+00:00", "processing_version": "1.0"}, "build_numbers": [], "kb_ids": ["KB-5034957", "KB-5034232", "KB-5025175"], "product_mentions": [], "cve_ids": "CVE-2022-41099 CVE-2024-20666", "noun_chunks": "[\"a major issue\", \"this script\", \"the previous vulnerability\", \"the new SafOS package\"]", "keywords": "['major issue', 'previous vulnerability cve', 'winre need patch', 'new safos package']", "node_label": "PatchManagementPost", "is_processed": false}, "added_at": "2025-01-03T16:35:22.316649", "last_updated": "2025-01-03T16:40:28.530250"}